# ãƒãƒƒã‚¯ã‚¢ãƒƒãƒ—ã¨å¾©å…ƒæ‰‹é †

## ðŸ“¦ ãƒãƒƒã‚¯ã‚¢ãƒƒãƒ—æƒ…å ±

- **ãƒãƒƒã‚¯ã‚¢ãƒƒãƒ—æ—¥æ™‚**: 2025-12-13 22:28
- **ãƒãƒ¼ã‚¸ãƒ§ãƒ³**: v1.0 - All features complete
- **å«ã¾ã‚Œã‚‹æ©Ÿèƒ½**:
  - âœ… ãƒ•ã‚¡ãƒ“ã‚³ãƒ³è¨­å®šæ©Ÿèƒ½
  - âœ… ãƒ¡ã‚¤ãƒ³ã‚¤ãƒ¡ãƒ¼ã‚¸ã®ã‚¹ãƒžãƒ¼ãƒˆãƒ•ã‚©ãƒ³æœ€é©åŒ–ï¼ˆ3æžšã¾ã§ã€PCç”»åƒãƒ•ã‚©ãƒ¼ãƒ«ãƒãƒƒã‚¯ï¼‰
  - âœ… ã“ã ã‚ã‚Šæƒ…å ±å‰Šé™¤æ™‚ã®ã‚¨ãƒ©ãƒ¼ä¿®æ­£
  - âœ… å…¨ç”»åƒã‚¢ãƒƒãƒ—ãƒ­ãƒ¼ãƒ‰æ©Ÿèƒ½ï¼ˆã”æŒ¨æ‹¶ã€ãƒ¡ãƒ‹ãƒ¥ãƒ¼ã€ã“ã ã‚ã‚Šã€ã‚®ãƒ£ãƒ©ãƒªãƒ¼ã€å®´ä¼šã‚³ãƒ¼ã‚¹ï¼‰
  - âœ… å…¨ç”»åƒ3MBåˆ¶é™ï¼ˆå‹•ç”»ã¯100MBï¼‰
  - âœ… ãƒ‡ãƒ¼ã‚¿ãƒ™ãƒ¼ã‚¹å®Œå…¨ãƒãƒƒã‚¯ã‚¢ãƒƒãƒ—

## ðŸ”— ãƒãƒƒã‚¯ã‚¢ãƒƒãƒ—ãƒ•ã‚¡ã‚¤ãƒ«

### 1. ãƒ—ãƒ­ã‚¸ã‚§ã‚¯ãƒˆå…¨ä½“ãƒãƒƒã‚¯ã‚¢ãƒƒãƒ—ï¼ˆtar.gzï¼‰
- **URL**: https://www.genspark.ai/api/files/s/U9VbiWXx
- **ãƒ•ã‚¡ã‚¤ãƒ«å**: webapp_complete_backup_20251213.tar.gz
- **ã‚µã‚¤ã‚º**: 545 KB
- **å†…å®¹**: å…¨ã‚½ãƒ¼ã‚¹ã‚³ãƒ¼ãƒ‰ã€è¨­å®šãƒ•ã‚¡ã‚¤ãƒ«ã€ãƒ‡ãƒ¼ã‚¿ãƒ™ãƒ¼ã‚¹ãƒãƒƒã‚¯ã‚¢ãƒƒãƒ—

### 2. ãƒ‡ãƒ¼ã‚¿ãƒ™ãƒ¼ã‚¹ãƒãƒƒã‚¯ã‚¢ãƒƒãƒ—ï¼ˆSQLï¼‰
- **ãƒ•ã‚¡ã‚¤ãƒ«å**: backups/database_backup_20251213_222854.sql
- **ã‚µã‚¤ã‚º**: 13 KB
- **å†…å®¹**: å…¨ãƒ†ãƒ¼ãƒ–ãƒ«ãƒ‡ãƒ¼ã‚¿ï¼ˆåº—èˆ—æƒ…å ±ã€ãƒ¡ã‚¤ãƒ³ã‚¤ãƒ¡ãƒ¼ã‚¸ã€ã“ã ã‚ã‚Šæƒ…å ±ã€ã‚®ãƒ£ãƒ©ãƒªãƒ¼ç­‰ï¼‰

## ðŸ”„ å¾©å…ƒæ‰‹é †

### æ–¹æ³•1: ãƒ—ãƒ­ã‚¸ã‚§ã‚¯ãƒˆå…¨ä½“ã‚’å¾©å…ƒï¼ˆæŽ¨å¥¨ï¼‰

#### Step 1: ãƒãƒƒã‚¯ã‚¢ãƒƒãƒ—ãƒ•ã‚¡ã‚¤ãƒ«ã‚’ãƒ€ã‚¦ãƒ³ãƒ­ãƒ¼ãƒ‰
```bash
# ä½œæ¥­ãƒ‡ã‚£ãƒ¬ã‚¯ãƒˆãƒªã«ç§»å‹•
cd /home/user

# ãƒãƒƒã‚¯ã‚¢ãƒƒãƒ—ãƒ•ã‚¡ã‚¤ãƒ«ã‚’ãƒ€ã‚¦ãƒ³ãƒ­ãƒ¼ãƒ‰
wget -O webapp_backup.tar.gz https://www.genspark.ai/api/files/s/U9VbiWXx
```

#### Step 2: æ—¢å­˜ãƒ—ãƒ­ã‚¸ã‚§ã‚¯ãƒˆã‚’ãƒãƒƒã‚¯ã‚¢ãƒƒãƒ—ï¼ˆå¿µã®ãŸã‚ï¼‰
```bash
# æ—¢å­˜ã®ãƒ—ãƒ­ã‚¸ã‚§ã‚¯ãƒˆã‚’åˆ¥åã§ä¿å­˜
mv webapp webapp_old_$(date +%Y%m%d_%H%M%S)
```

#### Step 3: ãƒãƒƒã‚¯ã‚¢ãƒƒãƒ—ã‚’å±•é–‹
```bash
# ãƒãƒƒã‚¯ã‚¢ãƒƒãƒ—ã‚’å±•é–‹
tar -xzf webapp_backup.tar.gz

# ãƒ—ãƒ­ã‚¸ã‚§ã‚¯ãƒˆãƒ‡ã‚£ãƒ¬ã‚¯ãƒˆãƒªã«ç§»å‹•
cd webapp

# ãƒ‘ãƒ¼ãƒŸãƒƒã‚·ãƒ§ãƒ³ç¢ºèª
chmod -R 755 .
```

#### Step 4: ä¾å­˜é–¢ä¿‚ã‚’ã‚¤ãƒ³ã‚¹ãƒˆãƒ¼ãƒ«
```bash
# Node.jsãƒ‘ãƒƒã‚±ãƒ¼ã‚¸ã‚’ã‚¤ãƒ³ã‚¹ãƒˆãƒ¼ãƒ«
npm install
```

#### Step 5: ãƒ‡ãƒ¼ã‚¿ãƒ™ãƒ¼ã‚¹ã‚’å¾©å…ƒ
```bash
# ãƒ­ãƒ¼ã‚«ãƒ«D1ãƒ‡ãƒ¼ã‚¿ãƒ™ãƒ¼ã‚¹ã‚’ãƒªã‚»ãƒƒãƒˆ
rm -rf .wrangler/state/v3/d1

# ãƒžã‚¤ã‚°ãƒ¬ãƒ¼ã‚·ãƒ§ãƒ³ã‚’é©ç”¨
npx wrangler d1 migrations apply webapp-production --local

# ãƒãƒƒã‚¯ã‚¢ãƒƒãƒ—ãƒ‡ãƒ¼ã‚¿ã‚’ã‚¤ãƒ³ãƒãƒ¼ãƒˆ
npx wrangler d1 execute webapp-production --local --file=backups/database_backup_20251213_222854.sql
```

#### Step 6: ãƒ“ãƒ«ãƒ‰ã¨èµ·å‹•
```bash
# ãƒ—ãƒ­ã‚¸ã‚§ã‚¯ãƒˆã‚’ãƒ“ãƒ«ãƒ‰
npm run build

# PM2ã§èµ·å‹•
pm2 start ecosystem.config.cjs

# å‹•ä½œç¢ºèª
curl http://localhost:3000
```

---

### æ–¹æ³•2: ãƒ‡ãƒ¼ã‚¿ãƒ™ãƒ¼ã‚¹ã®ã¿å¾©å…ƒ

ç¾åœ¨ã®ãƒ—ãƒ­ã‚¸ã‚§ã‚¯ãƒˆã¯ãã®ã¾ã¾ã§ã€ãƒ‡ãƒ¼ã‚¿ãƒ™ãƒ¼ã‚¹ã ã‘ã‚’ç‰¹å®šã®æ™‚ç‚¹ã«æˆ»ã—ãŸã„å ´åˆï¼š

```bash
cd /home/user/webapp

# ç¾åœ¨ã®ãƒ‡ãƒ¼ã‚¿ãƒ™ãƒ¼ã‚¹ã‚’ãƒãƒƒã‚¯ã‚¢ãƒƒãƒ—ï¼ˆå¿µã®ãŸã‚ï¼‰
npx wrangler d1 export webapp-production --local --output=backups/current_backup.sql

# ãƒ‡ãƒ¼ã‚¿ãƒ™ãƒ¼ã‚¹ã‚’ãƒªã‚»ãƒƒãƒˆ
rm -rf .wrangler/state/v3/d1

# ãƒžã‚¤ã‚°ãƒ¬ãƒ¼ã‚·ãƒ§ãƒ³ã‚’é©ç”¨
npx wrangler d1 migrations apply webapp-production --local

# ãƒãƒƒã‚¯ã‚¢ãƒƒãƒ—ãƒ‡ãƒ¼ã‚¿ã‚’ã‚¤ãƒ³ãƒãƒ¼ãƒˆ
npx wrangler d1 execute webapp-production --local --file=backups/database_backup_20251213_222854.sql

# ã‚µãƒ¼ãƒ“ã‚¹ã‚’å†èµ·å‹•
pm2 restart webapp
```

---

### æ–¹æ³•3: ç‰¹å®šã®ãƒ•ã‚¡ã‚¤ãƒ«ã®ã¿å¾©å…ƒ

ç‰¹å®šã®ãƒ•ã‚¡ã‚¤ãƒ«ã ã‘ã‚’å¾©å…ƒã—ãŸã„å ´åˆï¼š

```bash
# ãƒãƒƒã‚¯ã‚¢ãƒƒãƒ—ã‚’ä¸€æ™‚ãƒ‡ã‚£ãƒ¬ã‚¯ãƒˆãƒªã«å±•é–‹
mkdir -p /tmp/restore
tar -xzf webapp_backup.tar.gz -C /tmp/restore

# å¿…è¦ãªãƒ•ã‚¡ã‚¤ãƒ«ã‚’ã‚³ãƒ”ãƒ¼
# ä¾‹: ç‰¹å®šã®ãƒ«ãƒ¼ãƒˆãƒ•ã‚¡ã‚¤ãƒ«ã‚’å¾©å…ƒ
cp /tmp/restore/home/user/webapp/src/routes/admin-menu.ts /home/user/webapp/src/routes/

# ä¾‹: è¨­å®šãƒ•ã‚¡ã‚¤ãƒ«ã‚’å¾©å…ƒ
cp /tmp/restore/home/user/webapp/wrangler.jsonc /home/user/webapp/

# ãƒ“ãƒ«ãƒ‰ã—ã¦åæ˜ 
cd /home/user/webapp
npm run build
pm2 restart webapp
```

---

## ðŸ§ª å¾©å…ƒå¾Œã®ç¢ºèªé …ç›®

### 1. ã‚µãƒ¼ãƒ“ã‚¹ã®èµ·å‹•ç¢ºèª
```bash
# PM2ã®ãƒ—ãƒ­ã‚»ã‚¹ç¢ºèª
pm2 list

# ã‚µãƒ¼ãƒ“ã‚¹ã®ã‚¹ãƒ†ãƒ¼ã‚¿ã‚¹ç¢ºèª
curl http://localhost:3000

# ãƒ­ã‚°ç¢ºèª
pm2 logs webapp --nostream --lines 20
```

### 2. ãƒ‡ãƒ¼ã‚¿ãƒ™ãƒ¼ã‚¹ã®ç¢ºèª
```bash
# ãƒ†ãƒ¼ãƒ–ãƒ«ä¸€è¦§
npx wrangler d1 execute webapp-production --local --command="SELECT name FROM sqlite_master WHERE type='table'"

# åº—èˆ—æƒ…å ±ã®ç¢ºèª
npx wrangler d1 execute webapp-production --local --command="SELECT * FROM store_info LIMIT 1"

# ãƒ¡ã‚¤ãƒ³ã‚¤ãƒ¡ãƒ¼ã‚¸ã®ç¢ºèª
npx wrangler d1 execute webapp-production --local --command="SELECT COUNT(*) as count FROM main_images"
```

### 3. ãƒ•ãƒ­ãƒ³ãƒˆã‚¨ãƒ³ãƒ‰ã®ç¢ºèª
- ãƒ•ãƒ­ãƒ³ãƒˆãƒšãƒ¼ã‚¸ãŒæ­£å¸¸ã«è¡¨ç¤ºã•ã‚Œã‚‹
- ãƒ¡ã‚¤ãƒ³ã‚¤ãƒ¡ãƒ¼ã‚¸ã‚¹ãƒ©ã‚¤ãƒ€ãƒ¼ãŒå‹•ä½œã™ã‚‹
- ã“ã ã‚ã‚Šæƒ…å ±ãŒè¡¨ç¤ºã•ã‚Œã‚‹
- ã‚®ãƒ£ãƒ©ãƒªãƒ¼ãŒè¡¨ç¤ºã•ã‚Œã‚‹

### 4. ç®¡ç†ç”»é¢ã®ç¢ºèª
- ãƒ­ã‚°ã‚¤ãƒ³ã§ãã‚‹ï¼ˆadmin / admin123ï¼‰
- å„ç®¡ç†ç”»é¢ãŒæ­£å¸¸ã«è¡¨ç¤ºã•ã‚Œã‚‹
- ç”»åƒã‚¢ãƒƒãƒ—ãƒ­ãƒ¼ãƒ‰æ©Ÿèƒ½ãŒå‹•ä½œã™ã‚‹ï¼ˆ3MBåˆ¶é™ï¼‰
- ãƒ‡ãƒ¼ã‚¿ã®è¿½åŠ ãƒ»ç·¨é›†ãƒ»å‰Šé™¤ãŒæ­£å¸¸ã«å‹•ä½œã™ã‚‹

---

## ðŸ“ ãƒãƒƒã‚¯ã‚¢ãƒƒãƒ—ã®ãƒ™ã‚¹ãƒˆãƒ—ãƒ©ã‚¯ãƒ†ã‚£ã‚¹

### å®šæœŸçš„ãªãƒãƒƒã‚¯ã‚¢ãƒƒãƒ—
```bash
# ãƒãƒƒã‚¯ã‚¢ãƒƒãƒ—ã‚¹ã‚¯ãƒªãƒ—ãƒˆã‚’ä½œæˆ
cat > /home/user/webapp/backup.sh << 'SCRIPT'
#!/bin/bash
cd /home/user/webapp

# ãƒãƒƒã‚¯ã‚¢ãƒƒãƒ—ãƒ‡ã‚£ãƒ¬ã‚¯ãƒˆãƒªã‚’ä½œæˆ
mkdir -p backups

# ãƒ‡ãƒ¼ã‚¿ãƒ™ãƒ¼ã‚¹ã‚’ãƒãƒƒã‚¯ã‚¢ãƒƒãƒ—
npx wrangler d1 export webapp-production --local \
  --output=backups/db_$(date +%Y%m%d_%H%M%S).sql

# å¤ã„ãƒãƒƒã‚¯ã‚¢ãƒƒãƒ—ã‚’å‰Šé™¤ï¼ˆ30æ—¥ä»¥ä¸Šå‰ï¼‰
find backups/ -name "db_*.sql" -mtime +30 -delete

echo "Backup completed: $(date)"
SCRIPT

# å®Ÿè¡Œæ¨©é™ã‚’ä»˜ä¸Ž
chmod +x /home/user/webapp/backup.sh

# å®Ÿè¡Œ
./backup.sh
```

### Gitã§ã®ãƒãƒ¼ã‚¸ãƒ§ãƒ³ç®¡ç†
```bash
# é‡è¦ãªå¤‰æ›´ã®å‰ã«ã‚³ãƒŸãƒƒãƒˆ
git add .
git commit -m "Before major changes - backup point"

# ã‚¿ã‚°ã‚’ä»˜ã‘ã¦å¾©å…ƒãƒã‚¤ãƒ³ãƒˆã‚’æ˜Žç¢ºåŒ–
git tag -a v1.0-stable -m "Stable version with all features"
```

---

## âš ï¸ æ³¨æ„äº‹é …

1. **R2ã‚¹ãƒˆãƒ¬ãƒ¼ã‚¸ã®ç”»åƒã¯å«ã¾ã‚Œã¾ã›ã‚“**
   - ãƒãƒƒã‚¯ã‚¢ãƒƒãƒ—ã«ã¯R2ã«ã‚¢ãƒƒãƒ—ãƒ­ãƒ¼ãƒ‰ã•ã‚ŒãŸç”»åƒãƒ•ã‚¡ã‚¤ãƒ«ã¯å«ã¾ã‚Œã¾ã›ã‚“
   - `.wrangler/state/v3/r2/`å†…ã®ãƒ­ãƒ¼ã‚«ãƒ«R2ãƒ‡ãƒ¼ã‚¿ã¯å«ã¾ã‚Œã¾ã™
   - æœ¬ç•ªç’°å¢ƒã®R2ãƒ‡ãƒ¼ã‚¿ã¯åˆ¥é€”ãƒãƒƒã‚¯ã‚¢ãƒƒãƒ—ãŒå¿…è¦ã§ã™

2. **ç’°å¢ƒå¤‰æ•°**
   - `.env`ãƒ•ã‚¡ã‚¤ãƒ«ã¯`.gitignore`ã«å«ã¾ã‚Œã¦ã„ã‚‹ãŸã‚ã€æ‰‹å‹•ã§ãƒãƒƒã‚¯ã‚¢ãƒƒãƒ—ã—ã¦ãã ã•ã„
   - æœ¬ç•ªç’°å¢ƒã®ã‚·ãƒ¼ã‚¯ãƒ¬ãƒƒãƒˆã¯åˆ¥é€”è¨˜éŒ²ã—ã¦ãŠã„ã¦ãã ã•ã„

3. **Node.js ãƒãƒ¼ã‚¸ãƒ§ãƒ³**
   - å¾©å…ƒæ™‚ã¯åŒã˜Node.jsãƒãƒ¼ã‚¸ãƒ§ãƒ³ã‚’ä½¿ç”¨ã—ã¦ãã ã•ã„
   - ç¾åœ¨: Node.js v18ä»¥ä¸ŠæŽ¨å¥¨

4. **ãƒ‘ãƒ¼ãƒŸãƒƒã‚·ãƒ§ãƒ³**
   - å¾©å…ƒå¾Œã€é©åˆ‡ãªãƒ‘ãƒ¼ãƒŸãƒƒã‚·ãƒ§ãƒ³ã‚’è¨­å®šã—ã¦ãã ã•ã„
   - `chmod -R 755 /home/user/webapp`

---

## ðŸ“ž ãƒˆãƒ©ãƒ–ãƒ«ã‚·ãƒ¥ãƒ¼ãƒ†ã‚£ãƒ³ã‚°

### Q: å¾©å…ƒå¾Œã«ãƒ“ãƒ«ãƒ‰ã‚¨ãƒ©ãƒ¼ãŒå‡ºã‚‹
```bash
# node_modulesã‚’å‰Šé™¤ã—ã¦å†ã‚¤ãƒ³ã‚¹ãƒˆãƒ¼ãƒ«
rm -rf node_modules package-lock.json
npm install
npm run build
```

### Q: ãƒ‡ãƒ¼ã‚¿ãƒ™ãƒ¼ã‚¹ã®ã‚¤ãƒ³ãƒãƒ¼ãƒˆãŒå¤±æ•—ã™ã‚‹
```bash
# ãƒ‡ãƒ¼ã‚¿ãƒ™ãƒ¼ã‚¹ã‚’å®Œå…¨ã«ãƒªã‚»ãƒƒãƒˆ
rm -rf .wrangler/state/v3/d1
npx wrangler d1 migrations apply webapp-production --local

# SQLãƒ•ã‚¡ã‚¤ãƒ«ã‚’ç¢ºèª
head -20 backups/database_backup_20251213_222854.sql

# æ‰‹å‹•ã§å®Ÿè¡Œ
npx wrangler d1 execute webapp-production --local --file=backups/database_backup_20251213_222854.sql
```

### Q: PM2ãŒèµ·å‹•ã—ãªã„
```bash
# PM2ãƒ—ãƒ­ã‚»ã‚¹ã‚’å®Œå…¨ã«å‰Šé™¤
pm2 delete all
pm2 kill

# ãƒãƒ¼ãƒˆã‚’è§£æ”¾
fuser -k 3000/tcp

# å†èµ·å‹•
pm2 start ecosystem.config.cjs
```

---

## ðŸ“š é–¢é€£ãƒ‰ã‚­ãƒ¥ãƒ¡ãƒ³ãƒˆ

- ãƒ—ãƒ­ã‚¸ã‚§ã‚¯ãƒˆæ§‹é€ : `README.md`
- APIä»•æ§˜: `src/routes/`
- ãƒ‡ãƒ¼ã‚¿ãƒ™ãƒ¼ã‚¹ã‚¹ã‚­ãƒ¼ãƒž: `migrations/`

---

**ãƒãƒƒã‚¯ã‚¢ãƒƒãƒ—ä½œæˆè€…**: Claude AI Assistant  
**æœ€çµ‚æ›´æ–°**: 2025-12-13 22:28 JST
